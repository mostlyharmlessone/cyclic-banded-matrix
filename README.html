<!doctype html>
<html>
    <head>
        <title>Cyclic-banded-matrix</title>
        <meta charset='utf-8'/>
        <link rel="stylesheet" type="text/css" href="./cyclic.html_files/github-markdown.css">
        <style>
            .markdown-body {
                box-sizing: border-box;
                min-width: 200px;
                max-width: 980px;
                margin: 0 auto;
                padding: 45px;
            }
        </style>
        <script>
            window.onload = function() {
                if (document.querySelector("script[type=\"math/tex; mode=display\"]") !== null) {
                    var mathjax = document.createElement("script");
                    mathjax.src = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML";
                    document.head.appendChild(mathjax);
                }
                if (document.getElementsByTagName("code").length !== 0) {
                    var highlight = document.createElement("script");
                    var highlightcss = document.createElement("link");
                    highlight.src = "http://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.2.0/highlight.min.js";
                    highlightcss.rel = "stylesheet";
                    highlightcss.href = "http://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.2.0/styles/github.min.css";
                    highlight.onload = function() {hljs.initHighlighting();};
                    document.head.appendChild(highlight);
                    document.head.appendChild(highlightcss);
                }
            }
        </script>
    </head>
    <body>
        <article class="markdown-body">
            <h1 id="cyclic-banded-matrix">Cyclic-banded-matrix</h1>
<p>Cyclic-banded-matrix is fortran 90+ source code for solving cyclic/periodic square matrices.  The algorithm is detailed in <a href="https://github.com/mostlyharmlessone/cyclic-banded-matrix/blob/main/band_matrix.pdf">band_matrix.pdf</a>  </p>
<p>I have not found any previous version of this algorithm and it is entirely my derivation. If I have reinvented the wheel, there being nothing new under the sun, it would be interesting to see the previous attribution.</p>
<p>The error rate increases more rapidly with N than an LU decomposition, but is O(N*KU) in speed.  The matrix needs to be diagonally dominant.</p>
<h2 id="usage">Usage</h2>
<p>Two routines are included, dctsv.f90 which solves periodic tridiagonal systems, and dcbsv.f90, which solves general banded periodic matrices.
They are written to be reasonably easily incorporated into code using <a href="http://www.netlib.org/lapack/">LAPACK (Univ. of Tennessee, Univ. of California Berkeley and NAG Ltd.November 2006)</a> and the interfaces have been deliberately made as compatible as possible with their non-cyclic LAPACK counterparts dgbsv.f and dgtsv.f
Both use XERBLA error reporting and require linking with LAPACK &amp; BLAS. </p>
<p>Removing XERBLA from dctsv.f90 removes the LAPACK/BLAS dependency.</p>
<p>Removing the LAPACK/BLAS dependency in dcbsv requires substitution by intrinsic Fortran array operators instead of LAPACK &amp; BLAS calls and substitution of LAPACK&#39;s dgesv.f  &amp; dgetr(fsi).f by another suitable general matrix solver (e.g. the included gauss-jordan.f90).  The intrinsic operators and calls to the alternate matrix solver are commented out immediately after their respective LAPACK calls, making it easy to switch.</p>
<p>The algorithm can be run forwards or backwards, with dcbsv.f90, dcbsv_reverse.f90, or both simultaneously using OpenMP with dcbsv_parallel_omp.f90.  </p>
<p>A fortran 90 module LapackInterface.f90 is included for compatibility with FORTRAN 77. Note that the module only needs to be compiled once and is only needed for LAPACK/BLAS compatibility.</p>
<p>Two simple test programs are included, testme.f90 using full matrix routines as well as the LAPACK banded noncyclic routines dgtsv and dgbsv for comparison and testme_omp.f90 for larger N with a simple tridiagonal solver thomas.f90 for comparison purposes.</p>
<p>Using gfortran</p>
<pre><code>gfortran -c LapackInterface.f90
gfortran testme.f90 dctsv.f90 dcbsv.f90 gauss-jordan.f90 -llapack -lblas

or

gfortran testme.f90 LapackInterface.f90 dctsv.f90 dcbsv.f90 gauss-jordan.f90 -llapack -lblas

or (after commenting out dgesv in testme.f90)

gfortran testme.f90 dctsv.f90 dcbsv.f90 gauss-jordan.f90

or 

gfortran -O3 testme_large.f90 dctsv.f90 dcbsv.f90 thomas.f90 -llapack -lblas

or (after commenting out the lapack routines in testme_large.f90)

gfortran -O3 testme_large.f90 dctsv.f90 dcbsv.f90 thomas.f90 gauss-jordan.f90


parallel versions with OpenMP

gfortran -fopenmp -O3 testme_omp.f90 dcbsv_parallel.f90 dctsv_parallel.f90 thomas.f90 -llapack -lblas

./a.out
</code></pre><h2 id="contributing">Contributing</h2>
<p>Pull requests are welcome. For major changes, please open an issue first to discuss what you would like to change.</p>
<p>Please make sure to update tests as appropriate.</p>
<h2 id="license">License</h2>
<p><a href="https://github.com/mostlyharmlessone/cyclic-banded-matrix/blob/main/LICENSE">LICENSE</a></p>

        </article>
    </body>
</html>
